# NuDesk 티켓 상태 정의 (Ticket Statuses)

이 문서는 NuDesk 시스템의 티켓 상태(Status) 체계와 각 상태별 의미, 색상 가이드라인 및 상태 전환 규칙을 정의합니다.

## 1. 상태별 정의 및 UI 컬러

| 상태 코드 | 상태명 | 설명 | 테마 컬러 |
| :--- | :---: | :--- | :---: |
| **`WAITING`** | **대기** | 고객이 티켓을 등록했으나 아직 운영진이 확인하지 않은 상태 | `#F6AD55` (Orange) |
| **`ACCEPTED`** | **접수** | 운영진이 티켓을 확인하고 인력 배치 및 일정을 검토 중인 상태 | `#82B326` (Green) |
| **`IN_PROGRESS`** | **진행** | 담당 인력이 배치되어 실제 업무를 수행 중인 상태 | `#3B82F6` (Blue) |
| **`DELAYED`** | **지연** | 확정 종료일자가 경과했음에도 업무가 완료되지 않은 상태 | `#E53E3E` (Red) |
| **`REQUESTED`** | **요청** | 일정 연기 요청이나 추가 확인이 필요한 특수 상태 | `#242F67` (Navy) |
| **`COMPLETED`** | **완료** | 모든 업무 처리가 끝난 최종 상태 | `#9CA3AF` (Gray) |

---

## 2. 상태 전환 규칙 (State Transitions)

티켓은 특정 액션이나 조건에 따라 다음과 같이 상태가 변경됩니다.

### **2.1. 등록 단계**
*   **CUSTOMER 등록**: 최초 상태는 **`WAITING`**으로 생성됩니다.
*   **ADMIN / STAFF 등록**: 등록 시점에 인력과 일정이 지정되므로 즉시 **`ACCEPTED`** 상태로 생성됩니다.

### **2.2. 접수 및 착수 단계**
*   **`WAITING` → `ACCEPTED`**: ADMIN 또는 STAFF 권한의 유저가 티켓 상세 페이지에 진입하는 순간 자동으로 변경됩니다.
*   **`ACCEPTED` → `IN_PROGRESS`**: 상세 페이지 우측 영역에서 운영진이 **[전송 및 업무 시작]** 버튼을 눌러 메시지를 발송하면 변경됩니다. 
    *   이때 생성된 첫 메시지는 **`실무 착수 메시지`**로 분류되어 관리됩니다.
    *   확정 종료일자와 인력 배치가 최종 저장됩니다.

### **2.3. 지연 및 완료 단계**
*   **자동 지연 처리 (Auto-Delay)**:
    *   상태가 **`WAITING`**, **`ACCEPTED`**, **`IN_PROGRESS`**인 티켓의 **`confirmed_end_date`**(없으면 `initial_end_date`)가 현재 날짜(`today`)보다 지난 경우, 시스템은 실시간으로 상태를 **`DELAYED`**로 간주합니다.
    *   즉, `현재 일자 > 확정 종료일자`인 경우 자동으로 지연 상태가 됩니다.
    *   이때 **`confirmed_end_date`**가 비어있다면 **`initial_end_date`**의 날짜로 자동 동기화하여 표시합니다.
*   **`ANY` → `COMPLETED`**: 업무 완료 처리 시 최종적으로 도달합니다. 완료 상태에서는 댓글 작성이 비활성화됩니다.

---

## 3. UI/UX 표현 규칙

*   **배지 스타일**: 모든 테이블과 상세 페이지에서는 `outline` 스타일의 배지를 사용하며, 테두리 두께 2px와 `font-black` 속성을 적용합니다.
*   **잔여일자(D-Day) 표시**: 
    *   **기준**: `confirmed_end_date`가 있으면 해당 날짜를, 없으면 `initial_end_date`를 기준으로 계산합니다.
    *   **D- (미래)**: 파란색 (`#242F67`)으로 표시합니다.
    *   **D+ (지연)**: 빨간색 (`#E53E3E`)으로 표시합니다.
    *   **완료 상태**: 잔여일자 대신 하이픈(`-`)을 표시합니다.

---
*이 상태 정의는 시스템의 일관된 UI와 비즈니스 로직을 유지하기 위한 기준입니다.*
